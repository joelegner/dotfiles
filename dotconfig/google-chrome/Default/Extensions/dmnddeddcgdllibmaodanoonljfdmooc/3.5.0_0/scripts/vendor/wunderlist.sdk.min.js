!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),(t.wunderlist||(t.wunderlist={})).sdk=e()}}(function(){return function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return r(n?n:e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t){function n(){}var i=t.exports={};i.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var i=n.shift();i()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=n,i.addListener=n,i.once=n,i.off=n,i.removeListener=n,i.removeAllListeners=n,i.emit=n,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")}},{}],2:[function(e,t){(function(n,i){"use strict";var r=n.browser;if(r&&i.MagiConsole)t.exports=i.MagiConsole;else{var s=i.console,o=e("wunderbits.core/public/WBClass"),a=e("wunderbits.core/public/lib/assert"),c=e("wunderbits.core/public/lib/functions"),u=e("wunderbits.core/public/lib/toArray"),l={error:3,warn:4,log:5,info:6,debug:7},d=Object.keys(l),f={blue:"[34m",cyan:"[36m",green:"[32m",grey:"[90m",magenta:"[35m",red:"[31m",white:"[37m",yellow:"[33m"},p="[39m",v={debug:"cyan",error:"red",info:"grey",log:"white",warn:"yellow"};d.forEach(function(e){"function"!=typeof s[e]&&(s[e]=s.log)});var h={constructor:function(e){var t=this;a.string(e,"namespace must be a string");var n=m.namespaces;return n[e]instanceof m?n[e]:(t.namespace=e,n[e]=t,void o.call(t))},shouldRunLevel:function(e){var t=l[m.level],n=l[e];return void 0===t||void 0===n?!0:m.levelOnly?n===t:t>=n},shouldRun:function(e){var t=this,n=m.pattern,i=m.level,r=n&&n.test(t.namespace);return r=r&&(i?t.shouldRunLevel(e):!0),!(!r||!s)},colorizeString:function(e,t){return f[t]+e+p},colorizeNamespace:function(e,t){var n=v[t];return n&&(e=this.colorizeString(e,n)),e},colorizeStrings:function(e,t){var n=this;return t.forEach(function(i,r){"string"==typeof i&&(t[r]=n.colorizeNamespace(i,e))}),t},injectNamespace:function(e,t){var n=this;if(d.indexOf(e)>=0){t=u(t);var i="["+n.namespace.toUpperCase()+"]";"string"==typeof t[0]?t[0]=i+" "+t[0]:t.unshift(i),!r&&n.colorizeStrings(e,t)}return t}};c(s).forEach(function(e){h[e]=function(){var t=this,n=arguments;t.shouldRun(e)&&(n=t.injectNamespace(e,n),s[e].apply(s,n))}});var m=o.extend(h);if(m.release=function(){m.namespaces={}},m.reset=m.off=function(){m.pattern=void 0,m.level=void 0,m.levelOnly=!1},m.setPattern=function(e){a.string(e,"regexPatternString must be a string"),e="*"===e?".?":e,m.pattern=new RegExp(e)},m.setLevel=function(e,t){a.string(e,"logLevel must be a string"),e="*"===e?void 0:e,m.level=e,m.levelOnly=!!t},!r){var b=n.env,g=b.MLOG,y=b.MLEVEL;g&&m.setPattern(g),y&&m.setLevel(y,"true"===b.MLEVELONLY)}m.release(),m.reset(),t.exports=m}}).call(this,e("Rdh0rp"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{Rdh0rp:1,"wunderbits.core/public/WBClass":5,"wunderbits.core/public/lib/assert":13,"wunderbits.core/public/lib/functions":23,"wunderbits.core/public/lib/toArray":29}],3:[function(e,t){"use strict";var n=e("./WBEventEmitter").extend({mixins:[e("./mixins/WBDestroyableMixin"),e("./mixins/WBUtilsMixin"),e("./mixins/ObservableHashMixin")]});t.exports=n},{"./WBEventEmitter":7,"./mixins/ObservableHashMixin":33,"./mixins/WBDestroyableMixin":35,"./mixins/WBUtilsMixin":38}],4:[function(e,t){"use strict";var n=e("./WBSingleton").extend({mixins:[e("./mixins/WBEventsMixin"),e("./mixins/WBBindableMixin"),e("./mixins/WBDestroyableMixin"),e("./mixins/WBUtilsMixin"),e("./mixins/ObservableHashMixin")]});t.exports=n},{"./WBSingleton":10,"./mixins/ObservableHashMixin":33,"./mixins/WBBindableMixin":34,"./mixins/WBDestroyableMixin":35,"./mixins/WBEventsMixin":36,"./mixins/WBUtilsMixin":38}],5:[function(e,t){"use strict";function n(e,t){var i=this;e=e||{};var s=e.mixins||[];delete e.mixins;for(var o,a=r(i,e,t);s.length;)o=s.shift(),"function"==typeof o.applyToClass&&o.applyToClass(a);return a.extend=i.extend||n,a}function i(e){var t=this;t.uid=t.uid||a(),t.options=e||t.options,t.augmentProperties(),t.initialize.apply(t,arguments),t.initMixins.apply(t,arguments)}var r=e("./lib/inherits"),s=e("./lib/extend"),o=e("./lib/clone"),a=e("./lib/createUID"),c=e("./lib/fromSuper"),u={initialize:function(){var e=this;return e},initMixins:function(){for(var e,t=this,n=c.concat(t,"initializers");n.length;)e=n.shift(),"function"==typeof e&&e.apply(t,arguments)},augmentProperties:function(){function e(e,n){var i=typeof n;t[e]="function"===i?n.call(t):"object"===i?o(n,!0):n}var t=this,n=c.merge(t,"properties");for(var i in n)e(i,n[i])}};s(i.prototype,u),i.extend=n,t.exports=i},{"./lib/clone":14,"./lib/createUID":15,"./lib/extend":20,"./lib/fromSuper":22,"./lib/inherits":25}],6:[function(e,t){"use strict";function n(e,t,n){return function(){var i=this;if(!(i instanceof l))throw new Error(n+" invoked with wrong context");if(i._state!==a.pending)return i;i._args=o(arguments);var r=t?i._args.shift():void 0;return i._state=e,i.trigger(r),i}}var i=e("./WBClass"),r=e("./WBPromise"),s=e("./lib/assert"),o=e("./lib/toArray"),a={pending:0,resolved:2,rejected:4},c={0:["pending"],2:["resolved","resolve"],4:["rejected","reject"]},u={properties:{_state:a.pending,_args:[],handlers:[]},initialize:function(e){var t=this;t._context=e},state:function(){var e=this;return c[e._state][0]},trigger:function(e){var t=this;if(t._state!==a.pending)for(var n,i=t.handlers;i.length;)n=i.shift(),t.invoke(n,e||t._context)},invoke:function(e,t){var n=this,i=n._state,r=e.context||t||n,s=e.args;n._args.forEach(function(e){s.push(e)});var o=e.type,c="then"===o||"done"===o&&i===a.resolved||"fail"===o&&i===a.rejected;c&&e.fn.apply(r,s)},promise:function(){var e=this;return e._promise=e._promise||new r(this),e._promise}};["then","done","fail"].forEach(function(e){u[e]=function(){var t=this,n=o(arguments),i=n.shift(),r=n.shift();return s.function(i,e+" accepts only functions"),t.handlers.push({type:e,context:r,fn:i,args:n}),t.trigger(),t}}),u.always=u.then,[a.resolved,a.rejected].forEach(function(e){var t=c[e][1];u[t]=n(e,!1,t),u[t+"With"]=n(e,!0,t)});var l=i.extend(u);t.exports=l},{"./WBClass":5,"./WBPromise":9,"./lib/assert":13,"./lib/toArray":29}],7:[function(e,t){"use strict";var n=e("./WBClass").extend({mixins:[e("./mixins/WBBindableMixin"),e("./mixins/WBEventsMixin")]});t.exports=n},{"./WBClass":5,"./mixins/WBBindableMixin":34,"./mixins/WBEventsMixin":36}],8:[function(e,t){"use strict";var n=e("./lib/extend"),i=e("./lib/clone"),r=e("./lib/assert"),s=e("./WBSingleton"),o=s.extend({applyTo:function(e){var t,r=i(this.Behavior,!0);"function"==typeof r.initialize&&(t=r.initialize,delete r.initialize);var s=r.properties;return delete r.properties,n(e,r),t&&t.apply(e),s&&n(e,s),e},applyToClass:function(e){r.class(e,"applyToClass expects a class");var t=e.prototype,s=i(this.Behavior,!0),o=s.initialize;"function"==typeof o&&(!t.hasOwnProperty("initializers")&&(t.initializers=[]),t.initializers.push(o),delete s.initialize);var a=s.properties;return delete s.properties,n(t,s),!t.hasOwnProperty("properties")&&(t.properties={}),a&&n(t.properties,a),e}});o.extend=function(e,t){e||(e={}),t||(t={});var r=i(this.Behavior,!0);t.Behavior=n(r,e);var a=s.extend.call(this,t);return a.extend=o.extend,a},t.exports=o},{"./WBSingleton":10,"./lib/assert":13,"./lib/clone":14,"./lib/extend":20}],9:[function(e,t){"use strict";function n(e){return function(){var t=this.deferred;return t[e].apply(t,arguments),this}}var i=e("./WBClass"),r={constructor:function(e){this.deferred=e},promise:function(){return this},state:function(){return this.deferred.state()}};["done","fail","then"].forEach(function(e){r[e]=n(e)}),r.always=r.then,t.exports=i.extend(r)},{"./WBClass":5}],10:[function(e,t){"use strict";function n(e,t){for(var n;e.length;)n=e.shift(),"function"==typeof n.applyTo&&n.applyTo(t)}function i(e){e=e||{};var t=this||a;o.prototype=t;var c=new o,u=e.mixins||[];return e.mixins=void 0,n(u,c),r(c,e),c.extend=i,c.uid=s(),c}var r=e("./lib/extend"),s=e("./lib/createUID"),o=function(){};o.prototype={extend:i};var a=new o;t.exports=a},{"./lib/createUID":15,"./lib/extend":20}],11:[function(e,t){"use strict";var n=e("./WBClass"),i=e("./mixins/WBDestroyableMixin"),r=i.Behavior.destroy,s=n.extend({mixins:[e("./mixins/WBEventsMixin"),e("./mixins/WBStateMixin"),e("./mixins/WBBindableMixin"),i],initialize:function(e){var t=this;e&&(t.attributes=e)},sync:function(e,t,n){n&&"function"==typeof n.success&&n.success()},fetch:function(e){var t=this,n=e.success,i=this;return e.success=function(t){return i.set(t,e)?(n&&n(i,t,e),void i.trigger("sync",i,t,e)):!1},t.sync("read",t,e)},save:function(e,t,n){var i=this;return i.destroying||(i.set(e,t,n),"object"==typeof e&&(n=t),i.sync("update",i,n)),i},destroy:function(e){var t=this;t.destroying||(t.destroying=!0,r.call(t,e),t.attributes={},t.sync("delete",t,e))}});t.exports=s},{"./WBClass":5,"./mixins/WBBindableMixin":34,"./mixins/WBDestroyableMixin":35,"./mixins/WBEventsMixin":36,"./mixins/WBStateMixin":37}],12:[function(e,t){"use strict";t.exports={lib:e("./lib"),BaseEventEmitter:e("./BaseEventEmitter"),BaseSingleton:e("./BaseSingleton"),WBClass:e("./WBClass"),WBDeferred:e("./WBDeferred"),WBEventEmitter:e("./WBEventEmitter"),WBMixin:e("./WBMixin"),WBSingleton:e("./WBSingleton"),WBStateModel:e("./WBStateModel"),mixins:e("./mixins")}},{"./BaseEventEmitter":3,"./BaseSingleton":4,"./WBClass":5,"./WBDeferred":6,"./WBEventEmitter":7,"./WBMixin":8,"./WBSingleton":10,"./WBStateModel":11,"./lib":24,"./mixins":39}],13:[function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"")}function i(e){n[e]=function(t,i){n(typeof t===e,i)}}var r=Array.isArray;n.empty=function(e,t){var i=r(e)?e:Object.keys(e);n(0===i.length,t)},n.array=function(e,t){n(r(e),t)},n.class=function(e,t){var i=e.prototype;n(i&&i.constructor===e,t)},n.number=function(e,t){n("number"==typeof e&&!isNaN(e),t)};for(var s=["undefined","boolean","string","function","object"];s.length;)i(s.shift());t.exports=n},{}],14:[function(e,t){"use strict";function n(e,t){if(e=e.slice(),t){for(var n,i=[];e.length;)n=e.shift(),n=n instanceof Object?s(n,t):n,i.push(n);e=i}return e}function i(e){return new Date(e.getTime())}function r(e,t){var n={};for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];n[r]=o instanceof Date?i(o):"object"==typeof o&&null!==o&&t?s(o,t):o}return n}function s(e,t){return o(e)?n(e,t):r(e,t)}var o=Array.isArray;t.exports=s},{}],15:[function(e,t){"use strict";function n(){return 4294967295*d()|0}function i(){var e=n();return u[e&c]+u[e>>8&c]+u[e>>16&c]+u[e>>24&c]}function r(){var e=n();return u[e&c]+u[e>>8&c]+"-"+u[e>>16&15|64]+u[e>>24&c]}function s(){var e=n();return u[63&e|128]+u[e>>8&c]+"-"+u[e>>16&c]+u[e>>24&c]}function o(){var e=n();return u[e&c]+u[e>>8&c]+u[e>>16&c]+u[e>>24&c]}function a(e){var t=[i(),r(),s(),o()].join("-");return(e?e:"").toString()+t}for(var c=255,u=[],l=0;256>l;l++)u[l]=(16>l?"0":"")+l.toString(16);var d=Math.random;t.exports=a},{}],16:[function(e,t){"use strict";function n(e,t,n){var i;return function(){var r=this,s=arguments,o=function(){i=null,n||e.apply(r,s)},a=n&&!i;clearTimeout(i),i=setTimeout(o,t),a&&e.apply(r,s)}}t.exports=n},{}],17:[function(e,t){"use strict";function n(e){var t=i(arguments);return t[0]=1,t.unshift(e),r.apply(null,t)}var i=e("./toArray"),r=e("./delay");t.exports=n},{"./delay":18,"./toArray":29}],18:[function(e,t){"use strict";function n(e,t,n){var r=i(arguments,3);return setTimeout(function(){var t=n&&n.destroyed;!t&&e.apply(n,r)},t)}var i=e("./toArray");t.exports=n},{"./toArray":29}],19:[function(e,t){"use strict";var n=e("./assert"),i=e("./toArray"),r=e("./clone"),s=/\s+/,o={trigger:"Cannot trigger event(s) without event name(s)",events:"Cannot bind/unbind without valid event name(s)",callback:"Cannot bind/unbind to an event without valid callback function"},a={properties:{_events:{},_cache:{}},on:function(e,t,i){var r=this;return n.string(e,o.events),n.function(t,o.callback),r.iterate(e,function(e){r.bind(e,t,i);var n=r._cache;n[e]&&t.apply(i||r,n[e])}),r},off:function(e,t,i){var r=this;if(e&&n.string(e,o.events),!e&&!t&&!i)return r._events={},r;var s=e||Object.keys(r._events);return r.iterate(s,function(e){r.unbind(e,t,i)}),r},once:function(e,t,n){var r=this,s=i(arguments);return s[1]=function(){r.off.apply(r,s),t.apply(n||r,arguments)},r.on.apply(r,s),r},publish:function(e){var t=this,r=i(arguments);return n.string(e,o.events),t.iterate(e,function(e){var n=t._cache;n[e]||(n[e]=r.slice(1),r[0]=e,t.trigger.apply(t,r))}),t},unpublish:function(e){var t=this;return n.string(e,o.events),t.iterate(e,function(e){t._cache[e]=void 0}),t},unpublishAll:function(){var e=this;return e._cache={},e},trigger:function(e){var t=this;n.string(e,o.trigger);var r=i(arguments,1);return t.iterate(e,function(e){t.triggerEvent(e,r)}),t},triggerEvent:function(e,t){for(var n,i=this,r=i._events||{},s=[],o=e.split(":");o.length;)s.push(o.shift()),n=s.join(":"),n in r&&i.triggerSection(n,o,t)},triggerSection:function(e,t,n){var i=this,s=i._events||{},o=s[e]||[];o.forEach(function(e){var s;t.length&&(s=r(n),s.unshift(t)),e.callback.apply(e.context||i,s||n)})},iterate:function(e,t){var i=this,r=e;for("string"==typeof r?r=r.split(s):n.array(r);r.length;)t.call(i,r.shift())},bind:function(e,t,n){var i=this,r=i._events||{},s=r[e]||(r[e]=[]);return s.push({callback:t,context:n}),i},unbind:function(e,t,n){for(var i,r=this,s=r._events,o=s[e]||[],a=[],c=-1,u=o.length;++c<u;)i=o[c],(t&&t!==i.callback||n&&n!==i.context)&&a.push(i);return s[e]=a,r}};t.exports=a},{"./assert":13,"./clone":14,"./toArray":29}],20:[function(e,t){"use strict";function n(){var e=i(arguments);s(e.length>0,"extend expect one or more objects");for(var t=e.shift();e.length;)r(t,e.shift());return t}var i=e("./toArray"),r=e("./merge"),s=e("./assert");t.exports=n},{"./assert":13,"./merge":27,"./toArray":29}],21:[function(e,t){"use strict";function n(e,t,n){for(var i=0,r=e.length;r>i;i++)if(t.call(n,e[i],i,e)===!1)return}function i(e,t,n){for(var i in e)if(e.hasOwnProperty(i)&&t.call(n,e[i],i)===!1)return}function r(e,t,r){var s=Array.isArray(e)?n:i;s(e,t,r)}t.exports=r},{}],22:[function(e,t){"use strict";function n(e,t){var i=e.constructor,o=i.prototype,a={};e.hasOwnProperty(t)?a=e[t]:o.hasOwnProperty(t)&&(a=o[t]);var c=i&&i.__super__;return c&&(a=r(n(c,t),a)),s({},a)}function i(e,t){var n=e.constructor,r=n.prototype,s=[];e.hasOwnProperty(t)?s=e[t]:r.hasOwnProperty(t)&&(s=r[t]);var o=n&&n.__super__;return o&&(s=[].concat(i(o,t),s)),[].concat(s)}var r=e("./merge"),s=e("./extend");t.exports={merge:n,concat:i}},{"./extend":20,"./merge":27}],23:[function(e,t){"use strict";function n(e){var t=[];for(var n in e)"function"==typeof e[n]&&t.push(n);return t}t.exports=n},{}],24:[function(e,t){"use strict";t.exports={assert:e("./assert"),clone:e("./clone"),createUID:e("./createUID"),debounce:e("./debounce"),defer:e("./defer"),delay:e("./delay"),events:e("./events"),extend:e("./extend"),forEach:e("./forEach"),fromSuper:e("./fromSuper"),functions:e("./functions"),inherits:e("./inherits"),isEqual:e("./isEqual"),merge:e("./merge"),size:e("./size"),toArray:e("./toArray"),when:e("./when"),where:e("./where")}},{"./assert":13,"./clone":14,"./createUID":15,"./debounce":16,"./defer":17,"./delay":18,"./events":19,"./extend":20,"./forEach":21,"./fromSuper":22,"./functions":23,"./inherits":25,"./isEqual":26,"./merge":27,"./size":28,"./toArray":29,"./when":30,"./where":31}],25:[function(e,t){"use strict";function n(e,t,n){var r;return r=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},i(r,e),r.prototype=Object.create(e.prototype),i(r.prototype,t),r.prototype.constructor=r,i(r,n),r.__super__=e.prototype,r}var i=e("./extend");t.exports=n},{"./extend":20}],26:[function(e,t){"use strict";function n(e,t){return e===t}t.exports=n},{}],27:[function(e,t){"use strict";function n(e){for(var t,n=i(arguments,1);n.length;){t=n.shift();for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}return e}var i=e("./toArray");t.exports=n},{"./toArray":29}],28:[function(e,t){"use strict";function n(e){return!Array.isArray(e)&&(e=Object.keys(e)),e.length}t.exports=n},{}],29:[function(e,t){"use strict";function n(e){return e=e>0?e:0,new Array(e)}function i(e,t){for(var i=t||0,r=e.length,s=n(r-i),o=i;r>o;o++)s[o-i]=e[o];return s}t.exports=i},{}],30:[function(e,t){"use strict";function n(){function e(){s.rejectWith(this)}function t(){if("rejected"!==s.state()){var e=a-o.length-1;if(c[e]=r(arguments),o.length){var n=o.shift();n.done(t)}else c.unshift(this),s.resolveWith.apply(s,c)}}var n=this,s=new i(n),o=r(arguments);1===o.length&&Array.isArray(o[0])&&(o=o[0]);var a=o.length,c=new Array(a);if(o.length){o.forEach(function(t){t.fail(e)});var u=o.shift();u.done(t)}else s.resolve();return s.promise()}var i=e("../WBDeferred"),r=e("./toArray");t.exports=n},{"../WBDeferred":6,"./toArray":29}],31:[function(e,t){"use strict";function n(e,t){var n=[];return i(e,function(e){for(var i in t){if(e[i]!==t[i])return;n.push(e)}}),n}var i=e("./forEach");t.exports=n},{"./forEach":21}],32:[function(e,t){"use strict";var n=e("../WBMixin"),i=e("../lib/fromSuper"),r=n.extend({initialize:function(){var e=this;e.controllers=[],e.implemented=[],e.implements=i.concat(e,"implements"),e.createControllerInstances(),e.bindOnceTo(e,"destroy","destroyControllers")},createControllerInstances:function(){var e=this,t=e.implements;"function"==typeof t&&(t=t.call(e));var n,i,r;for(r=t.length;r--;)n=t[r],e.implemented.indexOf(n.toString())<0&&(i=new n(e),e.controllers.push(i),i.parent=e,e.trackImplementedSuperConstructors(n));return e.implemented},trackImplementedSuperConstructors:function(e){var t=this,n=e.__super__,i=n&&n.constructor;i&&(t.implemented.push(i.toString()),t.trackImplementedSuperConstructors(i))},destroyControllers:function(){for(var e,t=this,n=t.controllers;n.length;)e=n.shift(),e.destroyed||e.destroy()}});t.exports=r},{"../WBMixin":8,"../lib/fromSuper":22}],33:[function(e,t){"use strict";var n=e("../WBMixin"),i=e("../lib/fromSuper"),r=e("../lib/clone"),s=n.extend({initialize:function(){var e=this,t=i.merge(e,"observes");for(var n in t)e.bindToTarget(e.resolveTarget(n),t[n])},bindToTarget:function(e,t){var n=this;for(var i in t)n.bindHandlers(e,i,t[i])},bindHandlers:function(e,t,n){var i=this;for(n="string"==typeof n?[n]:r(n);n.length;)i.bindTo(e,t,n.shift())},resolveTarget:function(e){var t=this;if("self"===e)return t;var n=t[e];if(!n&&"string"==typeof e&&e.indexOf(".")>-1)for(e=e.split("."),n=t;e.length&&n;)n=n[e.shift()];return n}});t.exports=s},{"../WBMixin":8,"../lib/clone":14,"../lib/fromSuper":22}],34:[function(e,t){"use strict";var n=e("../WBMixin"),i=e("../lib/createUID"),r=n.extend({properties:{_bindings:{},_namedEvents:{}},callbackFactory:function(e,t){var n,i=this;return n="string"==typeof e?i.stringCallbackFactory(e,t):i.functionCallbackFactory(e,t)},stringCallbackFactory:function(e,t){return function(){t[e].apply(t,arguments)}},functionCallbackFactory:function(e,t){return function(){e.apply(t,arguments)}},bindTo:function(e,t,n,r){var s=this;s.checkBindingArgs.apply(s,arguments);var o=r||s,a=s.isAlreadyBound(e,t,n,o);if(a)return a;var c,u;s.isTargetJquery(e)?(c=s.callbackFactory(n,o),u=[t,c]):(c="string"==typeof n?o[n]:n,u=[t,c,o]),e.on.apply(e,u);var l={uid:i(),target:e,event:t,originalCallback:n,callback:c,context:o};return s._bindings[l.uid]=l,s.addToNamedBindings(t,l),l},isTargetJquery:function(e){var t=e.constructor;return t&&t.fn&&t.fn.on===e.on},bindOnceTo:function(e,t,n,r){var s=this;s.checkBindingArgs.apply(s,arguments),r=r||s;var o=s.isAlreadyBound(e,t,n,r);if(o)return o;var a=function(){("string"==typeof n?r[n]:n).apply(r,arguments),s.unbindFrom(c)},c={uid:i(),target:e,event:t,originalCallback:n,callback:a,context:r};return e.on(t,a,r),s._bindings[c.uid]=c,s.addToNamedBindings(t,c),c},unbindFrom:function(e){var t=this,n=e&&e.uid;if(!e||"string"!=typeof n)throw new Error("Cannot unbind from undefined or invalid binding");var i=e.event,r=e.context,s=e.callback,o=e.target;if(i&&s&&o&&r){o.off(i,s,r);for(var a in e)"uid"!==a&&delete e[a];delete t._bindings[n];var c=t._namedEvents,u=c[i];if(u){for(var l=u&&u.slice(0),d=u.length-1;d>=0;d--)u[d].uid===n&&l.splice(d,1);c[i]=l}}},unbindFromTarget:function(e){var t=this;if(!e||"function"!=typeof e.on)throw new Error("Cannot unbind from undefined or invalid binding target");var n;for(var i in t._bindings)n=t._bindings[i],n.target===e&&t.unbindFrom(n)},unbindAll:function(){var e,t=this;for(var n in t._bindings)e=t._bindings[n],t.unbindFrom(e)},checkBindingArgs:function(e,t,n,i){if(i=i||this,!e||"function"!=typeof e.on)throw new Error("Cannot bind to undefined target or target without #on method");if(!t||"string"!=typeof t)throw new Error("Cannot bind to target event without event name");if(!n||"function"!=typeof n&&"string"!=typeof n)throw new Error("Cannot bind to target event without a function or method name as callback");if("string"==typeof n&&!i[n])throw new Error("Cannot bind to target using a method name that does not exist for the context")},isAlreadyBound:function(e,t,n,i){var r=this,s=r._namedEvents[t];if(s)for(var o=0,a=s.length;a>o;o++){var c=s[o]||{},u=c.target;if(!u)return!1;var l=e.uid?e.uid===u.uid:!1;if(c.originalCallback===n&&c.context===i&&l)return c}return!1},addToNamedBindings:function(e,t){var n=this;n._namedEvents[e]||(n._namedEvents[e]=[]),n._namedEvents[e].push(t)}});t.exports=r},{"../WBMixin":8,"../lib/createUID":15}],35:[function(e,t){"use strict";function n(){}function i(e){var t=this;"string"==typeof e&&(e=t[e]),"function"==typeof e&&e.call(t)}var r=e("../lib/forEach"),s=e("../WBMixin"),o=["unbind","unbindAll","onDestroy"],a=s.extend({destroy:function(){var e=this;e.trigger("destroy"),r(o,i,e),e.destroyObject(e),e.destroyed=!0},destroyObject:function(e){var t=this;for(var n in e)t.destroyKey(n,e)},destroyKey:function(e,t){t.hasOwnProperty(e)&&"uid"!==e&&"cid"!==e&&(t[e]="function"==typeof t[e]?n:void 0)}});t.exports=a},{"../WBMixin":8,"../lib/forEach":21}],36:[function(e,t){"use strict";var n=e("../WBMixin"),i=e("../lib/events"),r=n.extend(i);t.exports=r},{"../WBMixin":8,"../lib/events":19}],37:[function(e,t){"use strict";var n=e("../lib/clone"),i=e("../lib/merge"),r=e("../lib/extend"),s=e("../lib/isEqual"),o=e("../WBMixin"),a=o.extend({attributes:{},options:{},initialize:function(e,t){var n=this;n.attributes=r({},n.defaults,e),n.options=t||{},n.changed={}},get:function(e){return console.warn("getters are deprecated"),this.attributes[e]},set:function(e,t,n){var r=this;if(null===e)return r;var s,o;if("object"==typeof e?(s=e,n=t):(s={},s[e]=t),n||(n={}),n.silent)i(r.attributes,o);else{var a=r.changes(s,n);r._trigger(s,a,n)}return r},unset:function(e,t){return this.set(e,void 0,r({},t,{unset:!0}))},clear:function(e){var t=this;return t.set(t.defaults,e)},changes:function(e,t){var i,r,o=this,a=[],c=n(o.attributes,!0),u=o.attributes;o.changed={};for(i in e)r=e[i],s(u[i],r)||a.push(i),s(c[i],r)?delete o.changed[i]:o.changed[i]=r,u[i]=t.unset?void 0:r;return a},_trigger:function(e,t,n){for(var i,r=this,s=r.attributes;t&&t.length&&r.trigger;)i=t.shift(),r.trigger("change:"+i,r,s[i],n)}});t.exports=a},{"../WBMixin":8,"../lib/clone":14,"../lib/extend":20,"../lib/isEqual":26,"../lib/merge":27}],38:[function(e,t){"use strict";var n=e("../WBMixin"),i=e("../WBDeferred"),r=e("../lib/when"),s=e("../lib/toArray"),o=e("../lib/forEach"),a=e("../lib/delay"),c=e("../lib/defer"),u=e("../lib/functions"),l=n.extend({deferred:function(){var e=this;return new i(e)},when:function(){var e=this;return r.apply(e,arguments)},defer:function(e){var t=this,n=s(arguments);return n[1]=n[1]||this,"string"==typeof e&&(n[0]=t[e]),c.apply(null,n)},delay:function(e){var t=this,n=s(arguments);return n[2]=n[2]||t,"string"==typeof e&&(n[0]=t[e]),a.apply(null,n)},forEach:function(e,t,n){var i=this;n=n||i,"string"==typeof t&&(t=i[t]),o(e,t,n)},functions:function(e){return u(e||this)}});t.exports=l},{"../WBDeferred":6,"../WBMixin":8,"../lib/defer":17,"../lib/delay":18,"../lib/forEach":21,"../lib/functions":23,"../lib/toArray":29,"../lib/when":30}],39:[function(e,t){"use strict";t.exports={ControllableMixin:e("./ControllableMixin"),ObservableHashMixin:e("./ObservableHashMixin"),WBBindableMixin:e("./WBBindableMixin"),WBDestroyableMixin:e("./WBDestroyableMixin"),WBEventsMixin:e("./WBEventsMixin"),WBStateMixin:e("./WBStateMixin"),WBUtilsMixin:e("./WBUtilsMixin")}},{"./ControllableMixin":32,"./ObservableHashMixin":33,"./WBBindableMixin":34,"./WBDestroyableMixin":35,"./WBEventsMixin":36,"./WBStateMixin":37,"./WBUtilsMixin":38}],40:[function(e,t){"use strict";t.exports={release:"0.0.0",clientID:void 0,webSocketTimeout:15e3,api:{host:"https://a.wunderlist.com/api"},realtime:{host:"wss://socket.wunderlist.com:8443/api/v1/sync"}}},{}],41:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBDeferred,r=i.prototype,s=i.extend({properties:{loadDurationTime:void 0,loadStarted:!1,loadStartTime:void 0,latencyTime:void 0,startTime:void 0,url:void 0,xhr:void 0},error:r.fail});t.exports=s},{"wunderbits.core":12}],42:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBDeferred,r=i.extend({properties:{startTime:void 0,endTime:void 0,requestID:void 0,uri:void 0}});t.exports=r},{"wunderbits.core":12}],43:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBSingleton,r=n.mixins.WBBindableMixin,s=n.mixins.WBEventsMixin,o=e("../io/IO"),a=15e3,c=i.extend({mixins:[r,s],init:function(e){var t=this;t.setupIO(e.config),t.startPolling()},destroy:function(){var e=this;e.poller&&clearInterval(e.poller)},setupIO:function(e){var t=this;t.io||(t.io=new o({config:e}).io)},startPolling:function(){var e=this;e.poller&&clearInterval(e.poller),e.poller=setInterval(function(){e.checkApiHealth()},a)},checkApiHealth:function(){var e=this;e.io.get("/health").done(e.onHealthy,e).fail(e.onUnhealthy,e)},onHealthy:function(){var e=this;e.trigger("healthy")},onUnhealthy:function(){var e=this;e.trigger("unhealthy")}});t.exports=c},{"../io/IO":46,"wunderbits.core":12}],44:[function(e,t){(function(n){"use strict";var i=e("wunderbits.core"),r=i.WBSingleton,s=n.navigator||{},o=n.process||{},a=s.userAgent||"node "+o.version,c=r.extend({headers:{"x-client-platform":"web","x-client-product":"wunderlist","x-client-product-version":null,"x-client-system":a,"x-client-system-version":"Standard","x-client-product-git-hash":null},init:function(e){var t=this,n=e,i=t.headers;i["x-client-product-version"]=n.release;var r=/\[(.*)\]/.exec(n.gitHash);r=r&&r[1],i["x-client-product-git-hash"]=r||"dev",n.testing&&(i["x-client-testing"]="true"),n.product&&(i["x-client-product"]=n.product)}});t.exports=c}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"wunderbits.core":12}],45:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBSingleton,r=i.extend({compileParams:function(e){var t,n=!0,i="";for(var r in e)t=encodeURIComponent(e[r]),i+=(n?"?":"&")+r+"="+encodeURIComponent(t),n&&(n=!1);return i},generateURI:function(e,t){var n=this;return e+n.compileParams(t)}});t.exports=r},{"wunderbits.core":12}],46:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.createUID,r=n.WBDeferred,s=n.mixins.WBBindableMixin,o=n.mixins.WBEventsMixin,a=e("../validators/SchemaValidator"),c=e("./IOBase"),u=c.prototype,l=e("magiconsole"),d=new l("SDK:IO"),f=c.extend({mixins:[s,o],initialize:function(e){var t=this;u.initialize.apply(t,arguments),t.config=e.config,t.requests={},t.wrapVerbs()},wrapVerbs:function(){var e=this,t=e.io;["get","patch","post","put","delete"].forEach(function(n){t["_"+n]=t[n],t[n]=e.requestWrapper.bind(e,n)})},requests:{},tokens:{id:"([-])?[0-9]+",version:"v(\\d)+",provider:"[a-z]+"},routes:{api:[]},authFreeRoutes:{api:["health","{{version}}/oauth/{{provider}}/exchange","{{version}}/signup","{{version}}/authenticate","{{version}}/user/password/reset"]},normalizeUrl:function(e){var t=this;return t.config.api.host+e},extendHeaders:function(e){var t=this,n=t.config.clientID,i=t.config.deviceID,r=t.config.instanceID;return n&&(e["x-client-id"]=n),i&&(e["x-client-device-id"]=i),r&&(e["x-client-instance-id"]=r),"function"==typeof t.config.extendHeaders&&t.config.extendHeaders(e),u.extendHeaders.apply(t,arguments)},setAuthorization:function(e){var t=this,n=t.config.accessToken;n&&(e["x-access-token"]=n)},requestWrapper:function(e,t,n,i,s){var o=this,c=new r,u={};return i||(i=o.generateUID()),o.requests[i]=c,u["x-client-request-id"]=i,s=s?parseInt(s,10):6e4,o.io["_"+e](t,n,u,s).done(function(e,n){Array.isArray(e)?e.forEach(function(e){e.type&&a.validateData(e,e.type)}):e&&e.type&&a.validateData(e,e.type),d.log(n.status,t),c.resolve(e,n.status)}).fail(function(e,n){d.error(n.status,n.statusText,t),c.reject(e,n.status),401===n.status&&o.trigger("unauthorized")}).always(function(){o.requests[i]=void 0}),c.promise()},generateUID:function(){for(var e,t=this;!e||!t.isUIDValid(e);)e=i();return e},isUIDValid:function(e){return!(e in this.requests)},cancelInflightCreate:function(e,t,n){var i=this,r=i.requests[e];if(d.debug("cancelling request locally",e,"alive?",!!r),r){i.requests[e]=void 0;var s=t?{id:t}:{};s.revision=n,r.resolve(s,200)}}});t.exports=f},{"../validators/SchemaValidator":120,"./IOBase":47,magiconsole:2,"wunderbits.core":12}],47:[function(e,t){(function(n){"use strict";var i=e("wunderbits.core"),r=i.WBClass,s=i.WBDeferred,o=i.lib.assert,a=i.lib.extend,c=e("./io/AjaxTransport"),u=e("../helpers/PlatformHeaders"),l=r.prototype,d=/^(https?:)?\/\//,f=/^(https?:)?\/\/\w+\.wunderlist.com\//;t.exports=r.extend({initialize:function(e){var t=this;t.config=e.config,c.maxRequests=t.config.maxHttpRequests||5,l.initialize.apply(t,arguments),t.io=c.ajax.bind(c);for(var n=["delete","get","patch","post","put"],i=0,r=n.length;r>i;i++)t.defineVerb(n[i]);t.routes=t.compileRoutes(t.routes,t.tokens),t.authFreeRoutes=t.compileRoutes(t.authFreeRoutes,t.tokens)},compileRoutes:function(e,t){function n(e){return e.replace(/\{\{(\w+)\}\}/g,function(e,n){return t[n]})}var i=this;if(!e)return void 0;var r={};for(var s in e){var o=e[s];o=o.map(n);var a=new RegExp("^/("+o.join("|")+")(\\?|$)"),c=i.config[s].host;r[c]=a}return r},resolveUrl:function(e){var t,n=this;return d.test(e)?e:(n.routes&&(t=n.resolveRoute(e)),t||(t=n.normalizeUrl(e)),t)},resolveRoute:function(e){var t=this;for(var n in t.routes){var i=t.routes[n];if(i.test(e))return n+e}},normalizeUrl:function(e){var t=n.location;return t.protocol+"//"+t.host+e},extendHeaders:function(e,t){var n=this,i=d.test(t),r=!i||f.test(t);if(e=e||{},r&&a(e,u.headers),n.authFreeRoutes)for(var s in n.authFreeRoutes){var o=n.authFreeRoutes[s];if(o.test(t))return e}return r&&!e.Authorization&&n.setAuthorization(e,t),e},setAuthorization:function(){},defineVerb:function(e){var t=this;t.io[e]=function(n,i,r,a,c){o(n,"need a url for ajax calls"),r=r||{},r=t.extendHeaders(r,n);var u=new s,l=u.promise();if(n=t.resolveUrl(n),"object"==typeof i)if("get"===e){var d,f=[];for(d in i)f.push(d+"="+encodeURIComponent(i[d]));f.length&&(n=n+"?"+f.join("&")),i=void 0}else i=JSON.stringify(i);return t.io(n,{type:e.toUpperCase(),data:i,headers:r,success:u.resolve.bind(u),error:u.reject.bind(u),timeout:a,context:c}),l
}}})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../helpers/PlatformHeaders":44,"./io/AjaxTransport":49,"wunderbits.core":12}],48:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.createUID,r=n.lib.extend,s=n.WBEventEmitter,o=n.WBDeferred,a=e("../helpers/PlatformHeaders"),c=e("./mixins/RequestQueueMixin"),u=e("../deferreds/RestSocketRequestDeferred"),l=e("../wunderbits/lib/SafeParse"),d=e("../validators/SchemaValidator"),f=e("../helpers/URL"),p=e("./io/WebSocket"),v=e("magiconsole"),h=new v("SDK:RESTSOCKET"),m=c.extend({maxRequests:100,executeRequest:function(e){var t=this,n=e.options;t.socketRequest(e.deferred,n.method,n.uri,n.data,n.requestID,n.requestType).always(function(){delete t.executingRequests[e.queueID],t.checkQueue()})}}),b=s.prototype,g=s.extend({mixins:[m],timeout:6e4,socket:void 0,ready:void 0,requests:{},initialize:function(e){var t=this;b.initialize.apply(t,arguments),t.appState=e.appState,t.config=e.config,t.ready=new o,t.socket=new p(e),t.requests={},t.wrapVerbs(),t.pollForTimeouts(),t.bindToSocket(),t.ready.resolve()},destroy:function(){var e=this;e.unbindAll(),e.socket&&e.socket.destroy(),e.destroyed=!0},wrapVerbs:function(){var e=this,t=["get","post","put","patch","delete"];t.forEach(function(t){var n=e[t];e[t]=function(){return n.apply(e,arguments)}})},pollForTimeouts:function(){var e=this;e.timer&&clearInterval(e.timer),e.timer=setInterval(function(){e.checkForRequestTimeouts()},1e3)},close:function(){var e=this;e.socket&&e.socket.close()},bindToSocket:function(){var e=this;e.bindTo(e.socket,"open","onSocketConnect"),e.bindTo(e.socket,"message","onMessage"),e.bindTo(e.socket,"close","onSocketFalure"),e.bindTo(e.socket,"close","onSocketDisconnect"),e.bindTo(e.socket,"error","onSocketFalure")},onSocketConnect:function(e){var t=this;t.getSocketHealth().done(function(){t.connected=!0,t.trigger("connected",e),t.pollHealth()}).fail(t.close,t)},pollHealth:function(){var e=this;e.cancelPollHealth(),e.poller=setInterval(function(){e.connected?e.getSocketHealth().fail(e.close,e):e.cancelPollHealth()},15e3)},cancelPollHealth:function(){var e=this;e.poller&&clearInterval(e.poller)},getSocketHealth:function(){var e=this,t=e.request(void 0,void 0,void 0,void 0,"health").done(function(e,t){h.info("websocket healthy",e||"",t)}).fail(function(e,t){h.error("websocket not healthy",e||"",t)});return t.promise()},onSocketDisconnect:function(e){var t=this;t.cancelPollHealth(),t.connected=!1,t.trigger("disconnected",e)},onMessage:function(e){var t=this,n=l.json(e.data);n&&n.headers&&(n.headers=t.normalizeHeaders(n.headers));var i=t.extractRequestIDFromHeaders(n),r=i&&t.requests[i];switch(t.parseDataBody(n),n.type){case"request":r&&t.handleRequest(r,n,i);break;case"health":r&&t.handleHealthRequest(r,n,i);break;case"desktop_notification":t.handleDesktopNotification(n);break;case"mutation":t.isCorrectMutationVersion(n)&&t.handleMessage(n);break;default:t.handleMessage(n)}},extractRequestIDFromHeaders:function(e){return e&&e.headers&&e.headers["x-client-request-id"]},parseDataBody:function(e){e&&e.body&&(e.body=l.json(e.body))},isCorrectMutationVersion:function(e){var t=!1,n=e.subject.type,i=e.version,r=["file"],s=-1!==r.indexOf(n),o=2===i,a=1===i;return s&&(o||a)?t=!0:a&&(t=!0),t},handleRequest:function(e,t,n){var i=this;e.endTime=Date.now();var r=/^2/.test(t.status);i.logRequestTimings(r,e,t),Array.isArray(t.body)?t.body.forEach(function(e){e.type&&d.validateData(e,e.type)}):t.body&&t.body.type&&d.validateData(t.body,t.body.type),e[r?"resolve":"reject"](t.body,t.status),i.checkStillAuthorized(t.status),i.requests[n]=void 0},handleHealthRequest:function(e,t,n){var i=this;e.endTime=Date.now();var r=t.body&&t.body.healthy===!0;i.logRequestTimings(r,e,t),e[r?"resolve":"reject"](t.body,t.status),i.requests[n]=void 0},logRequestTimings:function(e,t,n){var i=[n.status,t.uri,t.endTime-t.startTime];e?(this.triggerTiming(t),h.info.apply(h,i)):h.error.apply(h,i)},triggerTiming:function(e){var t=this,n=e.startTime;e.loadDurationTime=e.endTime-n,e.latencyTime=e.loadDurationTime;var i={start:n,end:e.endTime,duration:e.loadDurationTime,latency:e.latencyTime,download:void 0,url:e.uri,type:"websocket"};t.trigger("timing:io",i)},checkStillAuthorized:function(e){var t="unauthorized";401===e&&this.trigger(t)},handleMessage:function(e){var t=this;h.debug("arbitrary message",e);var n=e&&e.subject&&e.subject.type;n&&d.validateData(e.data,n),t.trigger("event",e);var i=e&&e.operation;i&&t.trigger(i,e)},handleDesktopNotification:function(e){var t=this;t.trigger("desktopNotification",e)},request:function(e,t,n,i,r){var s=this,o={method:e,uri:t,data:n,requestID:i,requestType:r},a=s.queueRequest(t,o,u);return a.promise()},socketRequest:function(e,t,n,i,r,s){var o=this,a=o.socket;r=r||o.generateUID();var c=o.compileHeaders(r),u={type:s||"request",headers:o.normalizeHeaders(c)};return t&&(u.verb=t),n&&(u.uri=n),"POST"!==t&&"PATCH"!==t&&"PUT"!==t||!i||(u.body=JSON.stringify(i)),e.requestID=r,e.uri=n,e.startTime=Date.now(),o.requests[r]=e,o.appState.isOnline()&&o.socket.isConnected()?a.send(JSON.stringify(u)):e.reject({errors:["no websocket connection available"]},0),e.promise()},compileHeaders:function(e){var t=this,n={"x-client-request-id":e,"x-client-id":t.appState.attributes.clientID,"x-client-instance-id":t.appState.attributes.instanceID,"x-client-device-id":t.appState.attributes.deviceID,"content-type":"application/json",accept:"application/json"};n=r(n,a.headers),t.config&&"function"==typeof t.config.extendHeaders&&t.config.extendHeaders(n);var i;for(var s in n)i=n[s],(void 0===i||null===i)&&delete n[s];return n},normalizeHeaders:function(e){var t={};for(var n in e)t[n.toLowerCase()]=e[n];return t},requestWrapper:function(e,t,n,i){var r=this,s=new o;return t="/api"+t,r.ready.done(function(){r.request(e,t,n,i).done(s.resolve.bind(s)).fail(s.reject.bind(s))}),s.promise()},onSocketFalure:function(){var e,t=this;for(var n in t.requests)e=t.requests[n],e&&e.reject({errors:["websocket connection lost"]},0),t.requests[n]=void 0},checkForRequestTimeouts:function(){var e=this,t=Date.now();for(var n in e.requests)e.checkRequestIsTimedout(e.requests[n],t)},checkRequestIsTimedout:function(e,t){var n=this;e&&t-e.startTime>=n.timeout&&(h.error("timeout",e.uri,t-e.startTime),e.reject({errors:["request timedout locally due to no response in "+n.timeout]},408),n.requests[e.requestID]=void 0)},"delete":function(e,t,n){var i=e+f.compileParams(t);return this.requestWrapper("DELETE",i,void 0,n)},get:function(e,t,n){var i=e+f.compileParams(t);return this.requestWrapper("GET",i,void 0,n)},patch:function(e,t,n){return this.requestWrapper("PATCH",e,t,n)},post:function(e,t,n){return this.requestWrapper("POST",e,t,n)},put:function(e,t,n){return this.requestWrapper("PUT",e,t,n)},generateUID:function(){for(var e,t=this;!e||!t.isUIDValid(e);)e=i();return e},isUIDValid:function(e){return!(e in this.requests)},cancelInflightCreate:function(e,t,n){var i=this,r=i.requests[e];if(h.debug("cancelling request locally",e,"alive?",!!r),r){i.requests[e]=void 0;var s=t?{id:t}:{};s.revision=n,r.resolve(s,200)}}});t.exports=g},{"../deferreds/RestSocketRequestDeferred":42,"../helpers/PlatformHeaders":44,"../helpers/URL":45,"../validators/SchemaValidator":120,"../wunderbits/lib/SafeParse":122,"./io/WebSocket":52,"./mixins/RequestQueueMixin":53,magiconsole:2,"wunderbits.core":12}],49:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBSingleton,r=n.mixins.WBBindableMixin,s=n.mixins.WBEventsMixin,o=e("../../helpers/URL"),a=e("../../wunderbits/lib/SafeParse"),c=e("./NativeXMLHttpRequest"),u=e("../../deferreds/RequestDeferred"),l=e("../mixins/RequestQueueMixin"),d=l.extend({maxRequests:5,executeRequest:function(e){var t=this,n=e.url,i=e.options,r=e.deferred;t.executingRequests[e.queueID]=e;var s=t.xhrRequest(n,{type:i.type,data:i.data,headers:i.headers,timeout:i.timeout},r);s.done(function(e,n){t.onSuccess(e,n,i)}).fail(function(e,n){t.onFailure(e,n,i)}).always(function(){delete t.executingRequests[e.queueID],t.checkQueue()})}}),f=i.extend({mixins:[r,s,d],xhrRequest:function(e,t,n){var i=this,r=!0,s=t.type,a=t.data;a&&"GET"===s&&(e=o.generateURI(e,a),a=void 0);var u=new c;return i.attachXhrListeners(u,n),u.open(s,e,r),t.timeout&&(u.timeout=t.timeout),i.setupXhrHeaders(u,t.headers,a),n.startTime=Date.now(),a?u.send(a):u.send(),n.url=e,n.xhr=u,n},setupXhrHeaders:function(e,t,n){var i="application/json; charset=utf-8";if(t)for(var r in t)e.setRequestHeader(r.toLowerCase(),t[r]);n&&e.setRequestHeader("Content-Type",i),e.setRequestHeader("Accept",i)},attachXhrListeners:function(e,t){var n=this;e.addEventListener("progress",function(i){n.onXhrProgress(i,e,t)},!1),e.addEventListener("load",function(i){n.onXhrLoad(i,e,t)},!1),e.addEventListener("error",function(i){n.onXhrError(i,e,t)},!1),e.addEventListener("abort",function(i){n.onXhrAbort(i,e,t)},!1),e.addEventListener("timeout",function(i){n.onXhrTimeout(i,e,t)},!1)},onXhrLoad:function(e,t,n){var i=this,r=2===parseInt(t.status/100,10);r&&i.triggerTiming(n),n[r?"resolve":"reject"].call(n,t.responseText,t)},triggerTiming:function(e){var t=this,n=Date.now(),i=e.startTime,r=e.loadStartTime;e.loadDurationTime=n-r,e.latencyTime=r-i,t.trigger("timing:io",{start:i,end:n,duration:n-i,latency:e.latencyTime,download:e.loadDurationTime,url:e.url,type:"ajax"})},onXhrProgress:function(e,t,n){n.loadStarted||(n.loadStartTime=Date.now(),n.loadStarted=!0)},onXhrError:function(e,t,n){this.onXhrFail(e,t,n)},onXhrAbort:function(e,t,n){this.onXhrFail(e,t,n)},onXhrTimeout:function(e,t,n){this.onXhrFail(e,t,n)},onXhrFail:function(e,t,n){n.reject(t.responseText,t)},ajax:function(e,t){var n=this,i=n.queueRequest(e,t,u);return i},onSuccess:function(e,t,n){"string"==typeof e&&204!==t.status&&(e=a.json(e)),n.success&&n.success(e,t)},onFailure:function(e,t,n){var i=(t.getResponseHeader("content-type")||"").split(";")[0];"string"==typeof e&&/application\/json/.test(i)&&(e=a.json(t.responseText)),"function"==typeof n.error&&n.error(e,t)}});t.exports=f},{"../../deferreds/RequestDeferred":41,"../../helpers/URL":45,"../../wunderbits/lib/SafeParse":122,"../mixins/RequestQueueMixin":53,"./NativeXMLHttpRequest":51,"wunderbits.core":12}],50:[function(e,t){(function(n){"use strict";t.exports=n.WebSocket||e("ws")}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],51:[function(e,t){(function(n){"use strict";t.exports=n.XMLHttpRequest||e("xmlhttprequest").XMLHttpRequest}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],52:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBEventEmitter,r=n.lib.assert,s=e("../../helpers/URL"),o=e("./NativeWebSocket"),a=e("../../wunderbits/lib/bindAll"),c=e("magiconsole"),u=new c("SDK:WEBSOCKET"),l=i.prototype,d=i.extend({clientClosed:!1,NativeWebSocketClass:o,socket:void 0,initialize:function(e){var t=this;t.appState=e.appState,l.initialize.apply(t,arguments);var n=["onSocketClose","onSocketError","onSocketMessage","onSocketOpen"];a(t,n),t.validateToken(),t.connect(),t.bindToAppState()},destroy:function(){var e=this;e.close(),e.unbindAll(),e.destroyed=!0},bindToAppState:function(){var e=this;e.appState&&(e.unbindFrom(e.appState),e.bindTo(e.appState,"change:online",function(){e[e.appState.isOnline()?"connect":"close"]()}))},validateToken:function(){r.string(this.appState.attributes.accessToken,"Cannot instantiate class without an auth token.")},connect:function(){var e=this;e.socket&&e.close(),e.clientClosed=!1,e.clearSocketTimeout();var t=e.appState.attributes,n={client_id:t.clientID,access_token:t.accessToken,client_device_id:t.deviceID,client_instance_id:t.instanceID},i=e.appState.attributes.realtime.host,r=s.generateURI(i,n),o=e.NativeWebSocketClass;e.socket=new o(r),e.bindToSocket()},isConnected:function(){var e=this.socket;return!(!e||1!==e.readyState)},send:function(e){this.socket.send(e)},close:function(){var e=this;e.clientClosed=!0,e.socket&&(e.socket.close(),e.socket=void 0)},bindToSocket:function(){var e=this,t=e.socket;t.addEventListener("close",e.onSocketClose),t.addEventListener("error",e.onSocketError),t.addEventListener("message",e.onSocketMessage),t.addEventListener("open",e.onSocketOpen),e.trackTimeout()},trackTimeout:function(){var e=this,t=e.appState.attributes.webSocketTimeout,n=Date.now(),i=function(){e.socket&&0===e.socket.readyState&&(Date.now()-n<t?e.socketTimeout=setTimeout(i,1e3):(e.onSocketTimeout(),e.socket&&(e.socket.close(),e.socket=void 0)))};i()},clearSocketTimeout:function(){var e=this;e.socketTimeout&&clearTimeout(e.socketTimeout)},onSocketTimeout:function(e){var t=this;t.clearSocketTimeout(),u.error("timeout",e),t.trigger("timeout")},onSocketError:function(e){var t=this;t.clearSocketTimeout(),u.error("error",e),t.trigger("error",e)},onSocketOpen:function(e){var t=this;u.info("opened",e),t.trigger("open",e)},onSocketClose:function(e){var t=this;t.clearSocketTimeout(),t.socket=void 0,u.info("closed",e),t.trigger("close",e),!t.clientClosed&&t.appState.isOnline()&&setTimeout(function(){!t.destroyed&&t.connect()},1e3)},onSocketMessage:function(e){var t=this;t.trigger("message",e)}});t.exports=d},{"../../helpers/URL":45,"../../wunderbits/lib/bindAll":123,"./NativeWebSocket":50,magiconsole:2,"wunderbits.core":12}],53:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.createUID,r=n.WBMixin;t.exports=r.extend({maxRequests:5,requestsQueue:[],executingRequests:{},reset:function(){var e=this;e.requestsQueue=[],e.executingRequests={}},checkQueue:function(){var e,t=this,n=Object.keys(t.executingRequests).length;n<t.maxRequests&&(e=t.requestsQueue.shift(),e&&t.executeRequest(e))},queueRequest:function(e,t,n){var r=this,s=new n;return r.requestsQueue.push({deferred:s,url:e,options:t,queueID:i()}),r.checkQueue(),s},executeRequest:function(e){throw new Error("You must override RequestQueueMixin#executeRequest!",e)}})},{"wunderbits.core":12}],54:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBDeferred,r=n.WBStateModel,s=n.lib.clone,o=e("../wunderbits/WBOnlineStatus"),a=r.prototype,c=r.extend({defaults:{api:{host:"https://a.wunderlist.com/api"},realtime:{host:"wss://socket.wunderlist.com:8443/api/v1/sync"},accessToken:void 0,clientID:void 0,debug:!1,online:!0,webSocketTimeout:15e3,maxHttpRequests:5,checkHealth:!0},initialize:function(){var e=this;a.initialize.apply(e,arguments),e.initialized=new i,setTimeout(function(){e.destroyed||(e.watchOnlineState(),e.initialized.resolve())})},destroy:function(){var e=this;e.onlineState&&e.onlineState.destroy(),a.destroy.apply(e,arguments)},watchOnlineState:function(){var e=this;e.onlineState&&(e.unbindFrom(e.onlineState),e.onlineState.destroy()),e.onlineState=new o({config:e.toJSON()}),e.set("online",e.onlineState.isOnline()),e.bindTo(e.onlineState,"online","onOnline"),e.bindTo(e.onlineState,"offline","onOffline")},onOnline:function(){this.set("online",!0)},onOffline:function(){this.set("online",!1)},isOnline:function(){return!!this.attributes.online},toJSON:function(){return s(this.attributes)}});t.exports=c},{"../wunderbits/WBOnlineStatus":121,"wunderbits.core":12}],55:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.clone,r=n.lib.extend,s=e("./SchemaTypes");t.exports={id:s.id,task_id:s.id,list_id:s.id,user_id:s.id,revision:s.int,type:s.str,created_at:s.ISODate,updated_at:s.ISODate,extend:function(e){return r(i(this),e)}}},{"./SchemaTypes":63,"wunderbits.core":12}],56:[function(e,t){"use strict";var n=e("./SchemaTypes");t.exports={id:n.id,title:n.str,list_ids:n.arr,user_id:n.id,created_at:n.ISODate,updated_at:n.ISODate,revision:n.int,type:n.str}},{"./SchemaTypes":63}],57:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({created_by_id:n.id,list_type:n.str,title:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],58:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({sender_id:n.id,state:n.str,owner:n.bool})},{"./BaseSchema":55,"./SchemaTypes":63}],59:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({content:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],60:[function(e,t){"use strict";var n=e("./SchemaTypes");t.exports={id:n.id}},{"./SchemaTypes":63}],61:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({values:n.arr})},{"./BaseSchema":55,"./SchemaTypes":63}],62:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({date:n.ISODate})},{"./BaseSchema":55,"./SchemaTypes":63}],63:[function(e,t){"use strict";t.exports={id:"integer","int":"integer",bool:"boolean",arr:"array",str:"string",ISODate:"ISODate"}},{}],64:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({user_id:n.id,provider_id:n.str,provider_type:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],65:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({key:n.str,value:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],66:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({completed:n.bool,completed_at:n.ISODate,completed_by_id:n.id,created_by_id:n.id,title:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],67:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({assignee_id:n.id,completed:n.bool,completed_at:n.ISODate,completed_by_id:n.id,created_by_id:n.id,due_date:n.ISODate,starred:n.bool,title:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],68:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({read:n.bool,text:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],69:[function(e,t){"use strict";var n=e("./SchemaTypes");t.exports={id:n.id,name:n.str,organization_id:n.id,created_at:n.ISODate,updated_at:n.ISODate,revision:n.int,team_type:n.str,type:n.str}},{"./SchemaTypes":63}],70:[function(e,t){"use strict";var n=e("./SchemaTypes"),i=e("./BaseSchema");t.exports=i.extend({name:n.str,email:n.str,pro:n.bool})},{"./BaseSchema":55,"./SchemaTypes":63}],71:[function(e,t){"use strict";var n=e("./Position");t.exports={list:e("./List"),folder:e("./Folder"),membership:e("./Membership"),note:e("./Note"),reminder:e("./Reminder"),setting:e("./Setting"),service:e("./Service"),subtask:e("./Subtask"),task:e("./Task"),task_comment:e("./TaskComment"),user:e("./User"),team:e("./Team"),organization:e("./Organization"),list_position:n,subtask_position:n,task_position:n}},{"./Folder":56,"./List":57,"./Membership":58,"./Note":59,"./Organization":60,"./Position":61,"./Reminder":62,"./Service":64,"./Setting":65,"./Subtask":66,"./Task":67,"./TaskComment":68,"./Team":69,"./User":70}],72:[function(e,t){"use strict";var n=e("./Conversations");t.exports=n.extend({baseUrl:"/activities",type:"activities"})},{"./Conversations":75}],73:[function(e,t){"use strict";var n=e("./Service");t.exports=n.extend({baseUrl:"/",login:function(e,t){var n=this,i={email:e,password:t};return n.post(n.baseUrl+"authenticate",i).promise()},signup:function(e,t,n,i,r){var s=this,o={name:e,email:t,password:n,password_confirmation:i,account_locale:r},a=s.post(s.baseUrl+"signup",o);return a.promise()},exchangeToken:function(e,t){var n=this,i={provider_token:t},r=n.baseUrl+"oauth/"+e+"/exchange",s=n.post(r,i);return s.promise()}})},{"./Service":102}],74:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.assert,r=e("./Service"),s=r.prototype;t.exports=r.extend({initialize:function(){var e=this;s.initialize.apply(e,arguments),e.validateAccessParams()},validateAccessParams:function(){var e=this,t=e.appState.attributes;i.string(t.clientID,"This service requires a client ID."),i.string(t.accessToken,"This service requires an access token.")}})},{"./Service":102,"wunderbits.core":12}],75:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/conversations",type:"conversations",all:function(e,t){var n=this;return n.get(n.baseUrl,e,t).promise()}})},{"./AuthenticatedService":74}],76:[function(e,t){"use strict";var n=e("./ServiceGetOnly");t.exports=n.extend({baseUrl:"/export",type:"export",all:function(e){var t=this;return t.get(t.baseUrl,void 0,e,3e5).promise()}})},{"./ServiceGetOnly":103}],77:[function(e,t){"use strict";var n=e("./ServiceGetOnly");t.exports=n.extend({baseUrl:"/features",type:"feature"})},{"./ServiceGetOnly":103}],78:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.assert,r=n.WBDeferred,s=e("magiconsole"),o=new s("SDK:SERVICE:FILES"),a=e("./AuthenticatedService"),c=a.prototype;t.exports=a.extend({apiVersion:2,baseUrl:"/files",type:"file",create:function(e,t){var n=this;try{n.validateCreateData(e)}catch(i){return o.error(i),(new r).reject({errors:[i.toString()]},0).promise()}var s=c.create.call(n,e,t);return s.promise()},validateCreateData:function(e){e=e||{};var t=Object.keys(e).length,n=" required for file creation";i(t,"data"+n),i.number(e.task_id,"data.task_id"+n)}})},{"./AuthenticatedService":74,magiconsole:2,"wunderbits.core":12}],79:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/folders",type:"folder"})},{"./AuthenticatedService":74}],80:[function(e,t){"use strict";var n=e("./Service");t.exports=n.extend({baseUrl:"/user/password/reset",requestReset:function(e,t){var n=this,i={email:e};return n.post(n.baseUrl,i,t)}})},{"./Service":102}],81:[function(e,t){"use strict";var n=e("./ServiceGetOnly");t.exports=n.extend({baseUrl:"/ical/feed",type:"ical_feed",getURL:function(e){var t=this;return t.get(t.baseUrl,void 0,e).promise()}})},{"./ServiceGetOnly":103}],82:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/import",type:"import",create:function(e,t){var n=this;return n.post(n.baseUrl,e,t,3e5).promise()}})},{"./AuthenticatedService":74}],83:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/invite_tokens",type:"invite_token",create:function(e,t){var n=this;return n.post(n.baseUrl,e,t)}})},{"./AuthenticatedService":74}],84:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/invites",type:"invite",create:function(e,t){var n=this;return n.post(n.baseUrl,e,t)}})},{"./AuthenticatedService":74}],85:[function(e,t){"use strict";var n=e("./ServiceGetOnly");t.exports=n.extend({baseUrl:"/invoices",type:"invoice"})},{"./ServiceGetOnly":103}],86:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/list_positions",type:"list_position"})},{"./AuthenticatedService":74}],87:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/list_reminders_collections",type:"list_reminders_collection"})},{"./AuthenticatedService":74}],88:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.assert,r=n.WBDeferred,s=e("magiconsole"),o=new s("SDK:SERVICE:LISTS"),a=e("./Memberships"),c=e("./AuthenticatedService"),u=c.prototype;t.exports=c.extend({baseUrl:"/lists",type:"list",initialize:function(e){var t=this;u.initialize.apply(t,arguments),t.membershipsService=new a(e)},create:function(e){var t=this;try{t.validateCreateData(e)}catch(n){return o.error(n),(new r).reject({errors:[n.toString()]},0).promise()}var i=u.create.apply(t,arguments);return i.promise()},accepted:function(){var e=this,t=new r;return e.membershipsService.mine().done(function(n){var i=n.filter(function(e){return"accepted"===e.state}),r=i.map(function(e){return e.list_id});e.all().done(function(e){var n=e.filter(function(e){return r.indexOf(e.id)>-1});t.resolve(n)}).fail(t.reject,t)}).fail(t.reject,t),t.promise()},validateCreateData:function(e){e=e||{},i(e.title,"Title is required for list creation.")}})},{"./AuthenticatedService":74,"./Memberships":89,magiconsole:2,"wunderbits.core":12}],89:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBDeferred,r=e("./User"),s=e("./AuthenticatedService"),o=s.prototype;t.exports=s.extend({baseUrl:"/memberships",type:"membership",initialize:function(e){var t=this;o.initialize.apply(t,arguments),t.userService=new r(e)},mine:function(){var e=this,t=new i;return e.userService.all().done(function(n){e.forUser(n.id).done(t.resolve,t).fail(t.reject,t)}).fail(t.reject,t),t.promise()}})},{"./AuthenticatedService":74,"./User":116,"wunderbits.core":12}],90:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBMixin,r=e("../../validators/SchemaValidator");t.exports=i.extend({validateData:function(e,t){r.validateData(e,t)}})},{"../../validators/SchemaValidator":120,"wunderbits.core":12}],91:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.assert,r=n.WBDeferred,s=e("magiconsole"),o=new s("SDK:SERVICE:CREATE"),a=e("./BaseServiceMixin");t.exports=a.extend({create:function(e,t){var n=this,s=e&&Object.keys(e).length;try{i(s,"Creation requires data.")}catch(a){return o.error(a),(new r).reject({errors:[a.toString()]},0).promise()}e=n.cleanCreateData(e);try{n.validateData(e,n.type)}catch(a){return o.error(a),(new r).reject({errors:[a.toString()]},0).promise()}return n.post(n.baseUrl,e,t)},cleanCreateData:function(e){for(var t in e)(null===e[t]||void 0===e[t])&&delete e[t];return e}})},{"./BaseServiceMixin":90,magiconsole:2,"wunderbits.core":12}],92:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBMixin,r=n.lib.assert,s=n.WBDeferred,o=e("magiconsole"),a=new o("SDK:SERVICE:DELETE"),c=e("../../helpers/URL");t.exports=i.extend({deleteID:function(e,t,n){try{r.number(e,"Deletion requires an id."),r.number(t,"Deletion requires a revision.")}catch(i){return a.error(i),(new s).reject({errors:[i.toString()]},0).promise()}var o={revision:t},u=c.compileParams(o),l=this;return l["delete"](l.baseUrl+"/"+e+u,void 0,n)}})},{"../../helpers/URL":45,magiconsole:2,"wunderbits.core":12}],93:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBMixin;t.exports=i.extend({getID:function(e,t){var n=this;return n.get(n.baseUrl+"/"+e,void 0,t)},getItemsForAttribute:function(e,t,n,i){var r=this,s={};return s[t]=n,r.get(e,s,i).promise()},forUser:function(e,t){var n=this;return n.getItemsForAttribute(n.baseUrl,"user_id",e,t)},forTask:function(e,t){var n=this;return n.getItemsForAttribute(n.baseUrl,"task_id",e,t)},forList:function(e,t){var n=this;return n.getItemsForAttribute(n.baseUrl,"list_id",e,t)},all:function(e){var t=this;return t.get(t.baseUrl,void 0,e).promise()},forAllLists:function(e){var t=this;return t.get(t.baseUrl+"/lists",void 0,e)},forAllTasksForList:function(e,t){var n=this;return n.getItemsForAttribute(n.baseUrl+"/tasks","list_id",e,t)}})},{"wunderbits.core":12}],94:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.assert,r=n.WBDeferred,s=e("magiconsole"),o=new s("SDK:SERVICE:UPDATE"),a=e("./BaseServiceMixin");t.exports=a.extend({update:function(e,t,n,s){var a=this,c=n&&Object.keys(n).length;try{i.number(e,"Updating a resource requires an id of type number."),i.number(t,"Updating a resource requires a revision of type number."),i(c,"Updating a resource requires data to be sent.")}catch(u){return o.error(u),(new r).reject({errors:[u.toString()]},0)}return n.revision=t,a.validateData(n,a.type),n=a.prepareDataForPatch(n),a.patch(a.baseUrl+"/"+e,n,s)},prepareDataForPatch:function(e){var t,n=[];for(var i in e)t=e[i],(null===t||void 0===t)&&(n.push(i),delete e[i]);return n.length&&(e.remove=n),e}})},{"./BaseServiceMixin":90,magiconsole:2,"wunderbits.core":12}],95:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/notes",type:"note",forList:function(e,t,n){var i=this,r=i.get(i.baseUrl,{list_id:e,completed_tasks:!!t},n);return r.promise()}})},{"./AuthenticatedService":74}],96:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/oauth/",connect:function(e,t){var n=this,i={provider_token:t},r=n.baseUrl+e+"/connect",s=n.post(r,i);return s.promise()}})},{"./AuthenticatedService":74}],97:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/payments/adyen",type:"payment",generateURL:function(e,t,n){var i=this,r={product:e,platform:t};return i.post(i.baseUrl+"/generate_url",r,n)}})},{"./AuthenticatedService":74}],98:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/previews",type:"preview",getPreview:function(e,t,n,i){var r=this,s={file_id:e,platform:t,size:n};return r.get(r.baseUrl,s,i)}})},{"./AuthenticatedService":74}],99:[function(e,t){"use strict";var n=e("./ServiceGetOnly");t.exports=n.extend({baseUrl:"/products",type:"product",all:function(e,t,n){var i=this,r={};return r.provider="adyen",e&&(r.currency=e),t&&(r.locale=t),r=Object.keys(r).length?r:void 0,i.get(i.baseUrl,r,n).promise()}})},{"./ServiceGetOnly":103}],100:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/reminders",type:"reminder",forList:function(e,t,n){var i=this,r=i.get(i.baseUrl,{list_id:e,completed_tasks:!!t},n);return r.promise()}})},{"./AuthenticatedService":74}],101:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/root",type:"root"})},{"./AuthenticatedService":74}],102:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBEventEmitter,r=n.lib.assert,s=e("../models/ApplicationState"),o=e("../io/IO"),a=e("./Mixins/ServiceCreate"),c=e("./Mixins/ServiceDelete"),u=e("./Mixins/ServiceGet"),l=e("./Mixins/ServiceUpdate"),d=["get","post","put","patch","delete"],f=i.prototype,p=i.extend({mixins:[a,c,u,l],baseUrl:void 0,apiVersion:1,type:void 0,io:void 0,"delete":void 0,get:void 0,patch:void 0,post:void 0,put:void 0,initialize:function(e){var t=this;f.initialize.apply(t,arguments),t.options=e=e||{},t.appState=e.appState,t.checkAppState(),t.baseUrl="/v"+t.apiVersion+t.baseUrl,t.options.websocket?t.setupSocketInterfaces():t.setupRestInterfaces()},setupRestInterfaces:function(){var e,t=this;e=t.options.httpIO?t.options.httpIO:new o({config:t.appState.toJSON()});var n=t.io=e;d.forEach(function(e){t[e]=n.io[e]}),t.bindTo(t.io,"unauthorized",function(){!t.destroyed&&t.trigger("unauthorized")})},checkAppState:function(){var e=this;!e.appState&&e.options.config&&(e.appState=new s(e.options.config),e.options.appState=e.appState)},setupSocketInterfaces:function(){var e=this,t=e.options.restSocket;r(t,"No RestSocket instance available."),e.io=t,d.forEach(function(t){e[t]=e.io[t]})},destroy:function(){function e(e){for(var t in e)e[t]=void 0}var t=this;t.unbindAll(),e(t),t.destroyed=!0},destroyed:!1});t.exports=p},{"../io/IO":46,"../models/ApplicationState":54,"./Mixins/ServiceCreate":91,"./Mixins/ServiceDelete":92,"./Mixins/ServiceGet":93,"./Mixins/ServiceUpdate":94,"wunderbits.core":12}],103:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.assert,r=e("./Service"),s=e("./Mixins/ServiceGet"),o=e("../io/IO"),a=function(){throw new Error("Method not allowed for this service.")};t.exports=r.extend({mixins:[s],setupRestInterfaces:function(){var e=this,t=e.io=new o({config:e.appState.toJSON()});e.get=t.io.get},setupSocketInterfaces:function(){var e=this,t=e.options.restSocket;i(t,"No RestSocket instance available."),e.io=t,e.get=e.io.get},"delete":a,patch:a,post:a,put:a})},{"../io/IO":46,"./Mixins/ServiceGet":93,"./Service":102,"wunderbits.core":12}],104:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/services",type:"service"})},{"./AuthenticatedService":74}],105:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/settings",type:"setting"})},{"./AuthenticatedService":74}],106:[function(e,t){"use strict";var n=e("./Service");t.exports=n.extend({baseUrl:"/subscriptions",type:"subscription"})},{"./Service":102}],107:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/subtask_positions",type:"subtask_position",forList:function(e,t,n){var i=this,r=i.get(i.baseUrl,{list_id:e,completed_tasks:!!t},n);
return r.promise()}})},{"./AuthenticatedService":74}],108:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.assert,r=n.WBDeferred,s=e("magiconsole"),o=new s("SDK:SERVICE:SUBTASKS"),a=e("./AuthenticatedService"),c=a.prototype;t.exports=a.extend({baseUrl:"/subtasks",type:"subtask",create:function(e){var t=this;try{t.validateCreateData(e)}catch(n){return o.error(n),(new r).reject({errors:[n.toString()]},0).promise()}var i=c.create.apply(t,arguments);return i.promise()},forList:function(e,t,n){var i=this,r=i.get(i.baseUrl,{list_id:e,completed_tasks:!!t},n);return r.promise()},validateCreateData:function(e){e=e||{};var t=Object.keys(e).length,n=" required for subtask creation";i(t,"data"+n),i.number(e.task_id,"data.task_id"+n),i.string(e.title,"data.title"+n)}})},{"./AuthenticatedService":74,magiconsole:2,"wunderbits.core":12}],109:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/task_comments",type:"task_comment"})},{"./AuthenticatedService":74}],110:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/task_comments_states",type:"task_comments_state"})},{"./AuthenticatedService":74}],111:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/task_positions",type:"task_position"})},{"./AuthenticatedService":74}],112:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.assert,r=n.WBDeferred,s=e("magiconsole"),o=new s("SDK:SERVICE:TASKS"),a=e("./AuthenticatedService"),c=a.prototype;t.exports=a.extend({baseUrl:"/tasks",type:"task",forList:function(e,t,n){var i=this,r=i.get(i.baseUrl,{list_id:e,completed:!!t},n);return r.promise()},create:function(e){var t=this;try{t.validateCreateData(e)}catch(n){return o.error(n),(new r).reject({errors:[n.toString()]},0).promise()}var i=c.create.apply(t,arguments);return i.promise()},validateCreateData:function(e){e=e||{};var t=Object.keys(e).length,n=" required for task creation";i(t,"data"+n),i.number(e.list_id,"data.list_id"+n),i.string(e.title,"data.title"+n)}})},{"./AuthenticatedService":74,magiconsole:2,"wunderbits.core":12}],113:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/lists/tasks_count",type:"tasks_count"})},{"./AuthenticatedService":74}],114:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/unread_activity_counts",type:"unread_activities_count"})},{"./AuthenticatedService":74}],115:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/uploads",type:"upload",create:function(e,t){var n=this;return n.post(n.baseUrl,e,t)},getPart:function(e,t,n){var i=this,r={part_number:t};return i.get(i.baseUrl+"/"+e+"/parts",r,n)},finish:function(e,t){var n=this,i={state:"finished"};return n.patch(n.baseUrl+"/"+e,i,t)}})},{"./AuthenticatedService":74}],116:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.assert,r=n.WBDeferred,s=e("magiconsole"),o=new s("SDK:SERVICE:USER"),a=e("./AuthenticatedService");t.exports=a.extend({baseUrl:"/user",type:"user",update:function(e,t,n){var s=this,a=t&&Object.keys(t).length;try{i.number(e,"Updating a user requires a revision of type number."),i(a,"Updating a user requires data to be sent.")}catch(c){return o.error(c),(new r).reject({errors:[c.toString()]},0).promise()}t.revision=e;try{s.validateData(t,s.type)}catch(c){return o.error(c),(new r).reject({errors:[c.toString()]},0)}return t=s.prepareDataForPatch(t),s.patch(s.baseUrl,t,n)},changeEmail:function(e,t,n){var i=this,r={email:e,password:t};return i.patch(i.baseUrl+"/email",r,n)},changePassword:function(e,t,n){var i=this,r={password:e,old_password:t};return i.patch(i.baseUrl+"/password",r,n)},deleteSelf:function(e,t){var n=this,i={password:e};return n["delete"](n.baseUrl,i,t)}})},{"./AuthenticatedService":74,magiconsole:2,"wunderbits.core":12}],117:[function(e,t){"use strict";var n=e("./Service");t.exports=n.extend({baseUrl:"/track"})},{"./Service":102}],118:[function(e,t){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/users",type:"user"})},{"./AuthenticatedService":74}],119:[function(e,t){"use strict";var n=e("./ServiceGetOnly"),i={activities:e("./Activities"),auth:e("./Auth"),conversations:e("./Conversations"),"export":e("./Export"),features:e("./Features"),files:e("./Files"),forgot_password:e("./ForgotPassword"),"import":e("./Import"),invites:e("./Invites"),invite_tokens:e("./InviteTokens"),invoices:e("./Invoices"),ical_feed:e("./IcalFeed"),folders:e("./Folders"),list_positions:e("./ListPositions"),list_reminders_collections:e("./ListRemindersCollections"),lists:e("./Lists"),memberships:e("./Memberships"),notes:e("./Notes"),oauth:e("./OAuth"),payments:e("./Payments"),previews:e("./Previews"),products:e("./Products"),reminders:e("./Reminders"),root:e("./Root"),services:e("./Services.js"),settings:e("./Settings"),subscriptions:e("./Subscriptions"),subtask_positions:e("./SubtaskPositions"),subtasks:e("./Subtasks"),task_comments:e("./TaskComments"),task_comments_states:e("./TaskCommentsStates"),task_positions:e("./TaskPositions"),tasks:e("./Tasks"),tasks_counts:e("./TasksCounts"),unread_activities_counts:e("./UnreadActivitiesCounts"),uploads:e("./Uploads"),user:e("./User"),userEvents:e("./UserEvents"),users:e("./Users")},r=["list","task"];r.forEach(function(e){var t=e+"_revisions";i[t]=n.extend({baseUrl:"/"+t,type:t})}),t.exports=i},{"./Activities":72,"./Auth":73,"./Conversations":75,"./Export":76,"./Features":77,"./Files":78,"./Folders":79,"./ForgotPassword":80,"./IcalFeed":81,"./Import":82,"./InviteTokens":83,"./Invites":84,"./Invoices":85,"./ListPositions":86,"./ListRemindersCollections":87,"./Lists":88,"./Memberships":89,"./Notes":95,"./OAuth":96,"./Payments":97,"./Previews":98,"./Products":99,"./Reminders":100,"./Root":101,"./ServiceGetOnly":103,"./Services.js":104,"./Settings":105,"./Subscriptions":106,"./SubtaskPositions":107,"./Subtasks":108,"./TaskComments":109,"./TaskCommentsStates":110,"./TaskPositions":111,"./Tasks":112,"./TasksCounts":113,"./UnreadActivitiesCounts":114,"./Uploads":115,"./User":116,"./UserEvents":117,"./Users":118}],120:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBSingleton,r=e("magiconsole"),s=new r("SDK:SCHEMAVALIDATOR"),o=e("../schemas"),a={array:"isArray",integer:"isInteger","boolean":"isBoolean",string:"isString",ISODate:"isISODate"},c=i.extend({validateData:function(e,t){var n,i,r,c,u=this,l=!0,d=o[t];if(!d)return s.warn('No data schema for type "'+t+'"'),!0;for(var f in e)r=void 0,n=d[f],n||s.warn("No validation set for key",f,"for",t),c=e[f],i=u[a[n]],i&&(r=i.call(u,c),r||(s.warn(t+" value "+c+" ("+typeof c+') for key "'+f+'"" did not pass validation for type '+n),l=!1));return l},isArray:function(e){return Array.isArray(e)},isBoolean:function(e){return e===!1||e===!0},isInteger:function(e){return"number"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},isString:function(e){return"string"==typeof e},isISODate:function(e){var t=this;if(!t.isString(e))return!1;var n=/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-2])T(0[0-9]|1[0-9]|2[0-3])(:([0-5][0-9])){2}(\.\d{3})?Z$/;return n.test(e)}});t.exports=c},{"../schemas":71,magiconsole:2,"wunderbits.core":12}],121:[function(e,t){(function(n){"use strict";var i=e("wunderbits.core"),r=i.WBEventEmitter,s=e("../helpers/HealthCheck"),o=n.navigator||{onLine:!0},a=r.extend({online:null,initialize:function(e){var t=this,i=n.document;if(t.online=o.onLine,n.addEventListener)n.addEventListener("online",t.onOnline.bind(t),!1),n.addEventListener("offline",t.onOffline.bind(t),!1);else if(i){var r=i.body;r.ononline=t.isOnline,r.onoffline=t.isOffline}e.config.checkHealth&&t.bindToApiHealth(e)},destroy:function(){s.destroy()},bindToApiHealth:function(e){var t=this;s.init(e),t.bindTo(s,"healthy","onOnline"),t.bindTo(s,"unhealthy","onOffline")},isOnline:function(){return this.online},onOnline:function(){var e=this;e.online=!0,e.trigger("online")},onOffline:function(){var e=this;e.online=!1,e.trigger("offline")}});t.exports=a}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../helpers/HealthCheck":43,"wunderbits.core":12}],122:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBSingleton,r=e("magiconsole"),s=new r("SDK:SAFEPARSE"),o=i.extend({json:function(e){try{return JSON.parse(e)}catch(t){s.warn('Unable to parse "'+e+'"')}}});t.exports=o},{magiconsole:2,"wunderbits.core":12}],123:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.lib.functions,r=[],s=function(){return function(e){for(var t,n=arguments.length>1?r.concat.apply(r,r.slice.call(arguments,1)):i(e);n.length;)t=n.shift(),"constructor"!==t&&(e[t]=e[t].bind(e))}}();t.exports=s},{"wunderbits.core":12}],124:[function(e,t){"use strict";var n=e("wunderbits.core"),i=n.WBEventEmitter,r=n.WBDeferred,s=n.lib.extend,o=e("../io/io/AjaxTransport"),a=e("../config/default"),c=e("../models/ApplicationState"),u=e("../io/IO"),l=e("../io/RestSocket"),d=e("../helpers/PlatformHeaders"),f=e("../services"),p=e("magiconsole"),v=i.prototype,h=i.extend({auth:void 0,state:void 0,online:void 0,initialized:void 0,http:void 0,socket:void 0,initialize:function(e){var t=this;v.initialize.apply(t,arguments),t.options=e=s(a,e||{}),t.setupLogging(t.options),t.validateOptions(),t.appState=new c(e),d.init(e);var n=f.auth;t.auth=new n({appState:t.appState});var i=t.state=new r;t.initialized=t.state.promise(),t.online=t.appState.isOnline(),t.start().done(i.resolveWith,i,t).fail(i.reject,i)},setupLogging:function(e){e.logLevel&&p.setLevel(e.logLevel),e.logPattern&&p.setPattern(e.logPattern)},isInitialized:function(){var e=this;return!(!e.initialized||"resolved"!==e.initialized.state())},start:function(){var e,t=this;return e=t.getServices(),t.bindTo(t.appState,"change:online","onOnlineOffline"),t.bindTo(o,"timing:io","onIOTiming"),e},onOnlineOffline:function(){var e=this;e.online=e.appState.isOnline(),e.trigger(e.online?"online":"offline")},onIOTiming:function(e){var t=this;t.trigger("timing:io",e)},getServices:function(){var e,t,n,i=this,s={http:{},socket:{}},o=new r,a=i.appState.attributes.accessToken;return i.createSocket(a).done(function(){i.http=void 0,i.socket=void 0,t=t||i.options.services||Object.keys(f),i.httpIO=new u({config:i.appState.toJSON()});for(var r=0,a=t.length;a>r;r++)e=t[r],n=f[e],s.http[e]=new n({appState:i.appState,httpIO:i.httpIO}),i.bindTo(s.http[e],"unauthorized",i.onUnauthorized),s.socket[e]=new n({websocket:!0,restSocket:i.restSocket,appState:i.appState});i.http=s.http,i.socket=s.socket,o.resolve(s)}),o.promise()},isSocketOnline:function(){var e=this,t=e.restSocket,n=t&&t.socket,i=!(!n||!n.isConnected());return i},getOutlet:function(){var e=this,t=e.isSocketOnline(),n=!!e.options.forceHTTP;return t&&!n?e.socket:e.http},createSocket:function(){var e=this;e.restSocket&&e.unbindFrom(e.restSocket);var t=new l({appState:e.appState,config:e.options});return e.restSocket=t,e.bindTo(t,"event",function(t){e.trigger("event",t)}),e.bindTo(t,"desktopNotification",function(t){e.trigger("desktopNotification",t)}),e.bindTo(t,"unauthorized",e.onUnauthorized),e.bindTo(t,"timing:io","onIOTiming"),t.ready.promise()},onUnauthorized:function(){var e=this;e.trigger("unauthorized"),e.destroy()},destroy:function(){function e(e){for(var t in e)e[t]=void 0}var t=this;t.restSocket&&t.restSocket.destroy(),t.unbindAll();var n=["http","socket"];n.forEach(function(e){var n;for(var i in t[e])n=t[e][i],n.destroy&&n.destroy();t[e]=void 0}),t.appState.destroy(),e(t),t.destroyed=!0},destroyed:!1,validateOptions:function(){var e=this,t=e.options||{},n=!!t.accessToken;if(!t.clientID||!n)throw new Error("Cannot initialize the Wunderlist SDK without a Client ID or auth credentials")},cancelInflightCreate:function(e,t,n){var i=this,r=i.restSocket,s=i.httpIO;r&&r.cancelInflightCreate(e,t,n),s&&s.cancelInflightCreate(e,t,n)}},{services:f,headers:d});t.exports=h},{"../config/default":40,"../helpers/PlatformHeaders":44,"../io/IO":46,"../io/RestSocket":48,"../io/io/AjaxTransport":49,"../models/ApplicationState":54,"../services":119,magiconsole:2,"wunderbits.core":12}]},{},[124])(124)});